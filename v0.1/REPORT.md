# Report

## 感染症シミュレーションプログラム

### 概要

本プログラムは、仮想的な合成人口データを用いて、感染症の拡大プロセスをシミュレートするものです。個人の属性（年齢、性別）、世帯構成、所属組織（学校や会社）といった社会的な構造を考慮し、日々の接触を通じて感染がどのように広がるかをモデル化します。

### 実装の詳細

#### 主要なクラス

*   **`Person`**: シミュレーション内の個人を表すクラス。
    *   属性: ID, 性別, 年齢, 所属世帯, 感染状態 (`SUSCEPTIBLE`, `INFECTED`, `RECOVERED`, `DECEASED`), 感染日など。

*   **`Family`**: 世帯を表すクラス。
    *   属性: ID, 世帯種別コード, 世帯メンバーのリスト。
    *   世帯内での感染を計算するために使用されます。

*   **`Organization`**: 学校や会社といった組織を表すクラス。
    *   属性: ID, 組織種別 (`school`, `company`), 所属メンバーのリスト。
    *   組織内での感染を計算するために使用されます。組織ごとに異なる感染率を設定できます。

*   **`Simulation`**: シミュレーション全体を管理するクラス。
    *   人口データ、組織データ、シミュレーションパラメータを保持します。
    *   `run_step` メソッドで1日ごとのシミュレーションを実行します。

#### データ読み込みと準備

1.  **`load_population`**: `population-*.csv` ファイルを読み込み、`Person` と `Family` オブジェクトを生成します。
2.  **`assign_organizations`**: 生成された人口データに基づき、個人を適切な組織（学校または会社）に割り当てます。
    *   6歳から18歳未満の個人は「学校」に所属します。
    *   18歳から65歳未満の個人は「会社」に所属します。会社の規模は、現実の組織規模分布を模倣するため、ポアソン分布に従って決定されます。

#### シミュレーションのロジック

シミュレーションは日次のステップで進行します。各ステップで、まず自己隔離が発生し、その後に以下の3つの経路で感染が拡大する可能性があります。

1.  **自己隔離**: 感染者は、感染してから一定期間が経過すると、確率で自己隔離状態に入ります。自己隔離中の個人は、組織内およびコミュニティでの感染拡大には寄与しませんが、世帯内では引き続き感染源となり得ます。
2.  **組織内感染**: 学校や会社内で、感染者（非隔離者）から同じ組織に所属する感受性者へ感染が広がります。感染確率は組織の種類（学校は密になりやすいため高めなど）によって異なります。
3.  **世帯内感染**: 同じ世帯に住む感染者（隔離者を含む）から、同居する感受性者へ感染が広がります。
4.  **コミュニティ感染**: 上記以外の接触（例：公共交通機関、店舗など）をモデル化します。シミュレーション内の全感染者（非隔離者）数に応じて、すべての感受性者に一定の確率で感染リスクを与えます。

感染した個人は、一定の回復期間（例：14日間）を経て、「回復」状態に遷移します。ごく一部は「死亡」することもあります。

### 実行結果

`population-1000.csv`（1000人規模の人口）を用い、5人の初期感染者で100日間のシミュレーションを実行したところ、感染の拡大と収束が確認できました。自己隔離の導入により、感染のピークが抑制される傾向が見られます。

### 今後の課題と判断

*   **パラメータの精緻化**: 現在の感染率、回復期間、自己隔離確率などのパラメータは仮のものです。現実のデータに基づき、より精緻なパラメータを設定する必要があります。
*   **詳細な組織モデル**: 現在の「学校」は1つだけです。複数の学校や、学年・クラスといったより詳細な構造をモデル化することが考えられます。
*   **PyStanとの連携**: シミュレーション結果を統計モデル（例：SIRモデル）と比較し、基本再生産数（R0）などの指標を推定することが、次のステップとして計画されています。

---
*この文書はGeminiによって生成されました。*