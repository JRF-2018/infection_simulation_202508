# 仮想合成人口個票の簡易な実装を用いた感染症シミュレーション

## 大目的

simple_synthetic_population を使ったシミュレーションを Python で作る。(ここで作った py ファイルは後に私が手動で Colab で ipynb にする。)


## 入力

まず↓のレポジトリをクローンする。

《JRF-2018/simple_synthetic_population: 仮想合成人口個票の簡易な実装》  
https://github.com/JRF-2018/simple_synthetic_population

ここの population-10000.csv または population-1000.csv を使ってシミュレーションしていく。

ここの README.md に csv の形式が書いてある。ただし世帯主コードは今回は使わない。

次のクラスを拡張して用いる。

```python
class Person:
    def __init__ (self):
        self.id = None         # 個人 ID
        self.sex = None        # 性別 'M' or 'F'
        self.age = None        # 年齢

class Family:
    def __init__ (self):
        self.id = None         # 世帯 ID
        self.code = None       # 世帯種コード
        self.num = None        # 世帯人数
        self.master = None     # 世帯主
        self.spouse = None     # 配偶者
        self.parents = []      # 親
        self.children = []     # 子供
        self.others = []       # 配偶者と親と子供以外
```

## 出力

シミュレーションプログラムを infection_simulation.py として出力する。py ファイルを分けたほうがよい場合は分けてよい。

プログラムの説明を REPORT.md で行う。やるべきでない(違う方法で)と判断したこともここに書く。

途中経過を WORKING.md に書く。途中で何らかの事情で gemini コマンドを終了しても、それを読めば途中から復帰・再開できるように書く。

REPORT.md と WORKING.md は Gemini さんの読み書き自由。


## どういうシミュレーションにしたいか？

  * 上の Person や Family を拡張し、職業や所属する組織などをよい感じに設定する。時間経過でどの組織に参加しているかが変わる中で、ある感染症がどのように広がるかをシミュレーションする。

  * 個人には、いくつかモードがあり、少なくともオンモードとオフモードがある。自己隔離中はオフモードになる。オンモードには生活史があり、それは組織移動にある。組織は組織人数(実構成員)と組織内感染度と全体感染度のパラメータを持つ。

  * 例えば、学校はクラスが最大30人とし、高い組織内感染度を持つ。また、全校に対する全体感染度を持つ。全校といっても全人口と接触するわけではないが、それは単純化して全人口と接触するとモデル化する。

  * 大人の一例は満員電車に乗って通勤し、組織(会社)に属し、夜の街(組織内感染度低いが全体感染度高い)に行って家に帰る…とする。

  * 大人男性と一部女性の組織の人数はポワソン分布でいいかな？ リタイアした人と主婦は感染しにくい感じで。この辺、イイ感じにパラメータを設定してください。

  * シミュレーション実行後、次の段階として CmdStanPy で SIR モデルとマッチングし、R0 や R(t) を計算します。

以上がバージョン 0.1 の段階です。前回の REPORT.md, WORKING.md, infection_simulation.py, sir.stan を残しておくのでそれも参照してください。


## バージョン 0.2 に向けての指示

  * 学校のクラスが最大30人というのを守ってください。学校をクラスによい感じに分けてください。

  * 時系列は1時間単位にします。「大人の一例は満員電車に乗って通勤し、組織(会社)に属し、夜の街(組織内感染度低いが全体感染度高い)に行って家に帰る…とする。」…という細かい設定をシミュレーションに組み込んでください。

  * 一旦、analyze_with_stan はコメントアウトして実行し、うまくいきそうなら、復活させましょう。

  * stan に入る前に、実行結果を何がしかファイルにプロットしておきましょう。

よろしくお願いします。

